<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>minecraft伺服器 - LOG</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';"/>
    <link href="./css/bootstrap-v5.min.css" rel="stylesheet">
    <script src="./css/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background-color: white;
            margin: 0;
        }

        #background {
            position: fixed;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
            width: 100%;
            height: 100%;
            background-color: black;
            margin: 0px;
            padding: 0px;
        }

        #console {
            margin: 0px;
            padding: 0px;
        }

        #consoletext {
            color: rgb(255, 255, 255);
            font-family: Monospace;
            margin: 10px 0px 0px 10px;
        }

        #textinput {
            resize: none;
            margin: 0px 0px 10px 10px;
            border: none;
            outline: none;
            background-color: rgb(0, 0, 0);
            color: rgb(255, 255, 255);
            font-family: Monospace;
            width: calc(100% - 20px);
            overflow: hidden;
        }
    </style>
</head>
<body>
<div style="padding-bottom: 10px;"></div>
<div class="container pb-2">
    <div class="col-sm-12">
        <form class="row1 gg-3 needs-validation " novalidate action="javascript:void(0);" id="frm1">

            <div class="card">
                <div class="card-header">伺 服 器 LOG</div>
                <div class="card-body">
                    <!-- start -->

                    <div id="background">
                        <div id="console">
                            <p id="consoletext">
                                Ispum dolor ugin hegar<br/>
                                dank daniel for life
                            </p>
                            <textarea rows="1" id="textinput" onkeydown="checkInput();"></textarea>
                        </div>
                    </div>

                    <!-- end -->
                </div>
            </div>

            <div class="mb-3">
            </div>

            <div class="mb-3 text-center">
                <button type="button" class="btn btn-dark col-3" onclick="btn_close();">關閉</button>
            </div>

        </form>
    </div>
</div>

<div style="padding-bottom: 10px;"></div>

</body>
</html>

<script>
    let consoleTitle = '[/form_view_server_log.html]';
    const {remote, ipcRenderer} = require('electron');
    const {app, dialog} = remote;

    //PS: 攔截錯誤送給 main process
    window.onerror = function(error, url, line) {
        ipcRenderer.send('errorInWindow', error, url, line);
    };

    const enums = remote.require('./common/enums');
    const myElectron = remote.require('./common/myElectron');
    const mydb = remote.getGlobal('MyDB');  //資料庫模組

    //....................................................................................
    /**
     * 接收主進程(index.js)的訊息
     */

    //載入伺服器資料到表單 - ok
    //call: app/index.js => ipcMain.on('openwin_form_server')
    ipcRenderer.on('load', async (event, param1) => {

        //console.log(consoleTitle, '[ipcRenderer][load] param1:', param1);
        await load_server_log(param1.server_id);

    });

    //....................................................................................
    //Form Element
    let form = document.getElementById('frm1');

    /**
     * 關閉視窗 - ok
     */
    let btn_close = () => {

        //ipcRenderer.send('ipcMain_RenderList', {s: 'btn_close', data: {}});   //PS: 傳遞給 [主進程]

        remote.getCurrentWindow().close();  //關閉自己

    }

    /**
     * 讀取修改的伺服器資料 - ok
     *
     * @param server_id
     * @return {Promise<void>}
     *
     * call: ipcRenderer.on('load')
     */
    let SERVER_ID = null;   //修改
    let load_server_log = async (server_id) => {

        let consoleTitle2 = consoleTitle + '[load_server]';
        //console.log(consoleTitle2, 'server_id:', server_id);

        if (server_id) {
            //PS: 修改

            //設定公用變數
            SERVER_ID = server_id;     //商城代碼

        } else {
            //PS: 新增

        }

    }
    //....................................................................................
</script>
